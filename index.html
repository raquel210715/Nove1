<!DOCTYPE html><html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App H√†bits Saludables</title>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function(){
      emailjs.init("TEU_PUBLIC_KEY");
    })();
  </script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .habit-circle {
      width: 30px; height: 30px; border: 2px solid black; border-radius: 50%;
      display: inline-flex; justify-content: center; align-items: center;
      margin: 5px; background: white; cursor: pointer;
    }
    .habit-circle.active { background: black; }
    .arrow { font-size: 30px; cursor: pointer; margin: 0 10px; }
    .pdf-box { border: 1px solid #ccc; padding: 10px; border-radius: 10px;
      display: flex; align-items: center; margin: 10px 0; }
    .pdf-box i { font-size: 24px; margin-right: 10px; }
    .popup {
      display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: white; padding: 20px; border: 2px solid black; border-radius: 10px;
    }
    .popup.active { display: block; }
    .overlay { display:none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); }
    .overlay.active { display:block; }
    .btn { cursor:pointer; padding:8px 12px; border:none; border-radius:5px; }
    .btn-reset { background:#f55; color:white; margin-top:20px; }
    .btn-close { background:#aaa; color:white; margin-top:10px; }
    .send-btn { font-size: 40px; cursor:pointer; }
  </style>
</head>
<body>
  <div id="login-screen">
    <h2>Introdueix el teu codi i email</h2>
    <input type="text" id="userCode" placeholder="Codi"><br><br>
    <input type="email" id="userEmail" placeholder="Email"><br><br>
    <button onclick="enterApp()">Entrar</button>
  </div>  <div id="app-screen" style="display:none;">
    <h2 id="current-date"></h2>
    <div>
      <span class="arrow" onclick="prevDay()">&#8592;</span>
      <span class="arrow" onclick="nextDay()">&#8594;</span>
    </div><h3>H√†bits</h3>
<div id="habits"></div>

<h3>Exercicis</h3>
<div class="pdf-box">
  <i>üí™</i> <a href="pdf/pdf-propioceptiu.pdf" target="_blank">Propiocetiu</a>
</div>
<div class="pdf-box">
  <i>üí™</i> <a href="pdf/pdf-forca.pdf" target="_blank">For√ßa</a>
</div>
<div class="pdf-box">
  <i>üí™</i> <a href="pdf/pdf-extra.pdf" target="_blank">Extra</a>
</div>

<h3>Salut</h3>
<div class="pdf-box" onclick="openTAPopup()">
  <i>ü©∫</i> Mesura la TA
</div>

<br>
<span class="send-btn" onclick="sendEmail()">‚úâÔ∏è</span>
<br>
<button class="btn btn-reset" onclick="resetApp()">Reiniciar</button>

  </div>  <!-- Popup TA -->  <div id="overlay" class="overlay"></div>
  <div id="ta-popup" class="popup">
    <h3>Introdueix la teva TA</h3>
    <input type="number" id="ta-sis" placeholder="Sist√≤lica"><br><br>
    <input type="number" id="ta-dia" placeholder="Diast√≤lica"><br><br>
    <input type="number" id="ta-puls" placeholder="Puls"><br><br>
    <label>Foto: <input type="file" id="ta-photo"></label><br><br>
    <button class="btn-close" onclick="closeTAPopup()">Tancar</button>
  </div>  <script>
    let currentDate = new Date();
    let habitsData = {};

    function renderDate(){
      document.getElementById("current-date").innerText = currentDate.toDateString();
      renderHabits();
    }

    function prevDay(){ currentDate.setDate(currentDate.getDate()-1); renderDate(); }
    function nextDay(){ currentDate.setDate(currentDate.getDate()+1); renderDate(); }

    function renderHabits(){
      const container = document.getElementById("habits");
      container.innerHTML = "";
      if(!habitsData[currentDate]) habitsData[currentDate] = [false,false,false,false,false];
      habitsData[currentDate].forEach((active,i)=>{
        const circle=document.createElement("div");
        circle.className="habit-circle"+(active?" active":"");
        circle.onclick=()=>{
          habitsData[currentDate][i]=!habitsData[currentDate][i];
          renderHabits();
        };
        container.appendChild(circle);
      });
    }

    function enterApp(){
      document.getElementById("login-screen").style.display="none";
      document.getElementById("app-screen").style.display="block";
      renderDate();
    }

    function resetApp(){
      document.getElementById("login-screen").style.display="block";
      document.getElementById("app-screen").style.display="none";
    }

    function openTAPopup(){
      document.getElementById("overlay").classList.add("active");
      document.getElementById("ta-popup").classList.add("active");
    }

    function closeTAPopup(){
      document.getElementById("overlay").classList.remove("active");
      document.getElementById("ta-popup").classList.remove("active");
    }

    function sendEmail(){
      const email = document.getElementById("userEmail").value;
      const code = document.getElementById("userCode").value;
      const taSis = document.getElementById("ta-sis").value;
      const taDia = document.getElementById("ta-dia").value;
      const taPuls = document.getElementById("ta-puls").value;
      const photo = document.getElementById("ta-photo").files[0]?.name || "No adjuntada";
      
      emailjs.send("TEU_SERVICE_ID","TEU_TEMPLATE_ID",{
        email: email,
        code: code,
        habits: habitsData[currentDate],
        ta_sistolica: taSis,
        ta_diastolica: taDia,
        ta_puls: taPuls,
        photo: photo
      }).then(()=>{
        alert("Enviat correctament!");
      }).catch(err=>{
        alert("Error enviant: "+JSON.stringify(err));
      });
    }
  </script></body>
</html>
